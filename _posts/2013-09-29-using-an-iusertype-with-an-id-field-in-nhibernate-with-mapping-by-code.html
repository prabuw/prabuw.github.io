---
layout: post
title: Using an IUserType with an Id field in NHibernate with Mapping-By-Code
categories:
- NHibernate
tags:
- IUserType
- Mapping-By-Code
- NHibernate
status: publish
type: post
published: true
meta:
  _publicize_pending: '1'
author: 
---
<p align="justify">I couldn’t find any documentation on how to do this on the <a href="http://www.urbandictionary.com/define.php?term=interwebs" target="_blank">interwebs</a>, so I’ve chucked it up here. This is mostly so I can revert to it when I do need it again and have almost certainly forgotten how to do it!</p>
<p align="justify">I've used the ComposedId property of NHibernate Mapping-By-Code. This also requires you to override the Equals and GetHashCode methods on the entity class, as the ComposedId property is generally used to represent composite keys of a database table,</p>
<p align="justify">I have excluded the implementation of the IUserType classes to keep the post short, In&nbsp;case you wanted to know how to implement an IUserType, check out my <a href="http://pwee167.wordpress.com/2013/09/07/nhibernate-mapping-by-code-and-iusertypes/" target="_blank">post on it</a>.</p>
<div class="wlWriterEditableSmartContent" id="scid:C89E2BDB-ADD3-4f7a-9810-1B7EACF446C1:7aeedce5-606f-4000-b358-0a5105805482" style="float:none;margin:0;display:inline;padding:0;">[sourcecode language="csharp" padlinenumbers="true" highlight="6,15,27,28,29,30,31"]<br />
public class ExampleEntity<br />
{<br />
    public virtual String MyIdColumn { get; set; }<br />
    public virtual Country Country { get; set; }</p>
<p>    public override bool Equals(object obj)<br />
    {<br />
        var exampleEntity = obj as ExampleEntity;<br />
        if (exampleEntity != null)<br />
            return exampleEntity.MyIdColumn == MyIdColumn ;</p>
<p>        return false;<br />
    }</p>
<p>    public override int GetHashCode()<br />
    {<br />
        return MyIdColumn.GetHashCode();<br />
    }<br />
}</p>
<p>public class ExampleEntityMap : ClassMapping<br />
{<br />
    public ExampleEntityMap()<br />
    {<br />
        Table(&quot;Table&quot;);</p>
<p>        ComposedId(i =&gt; i.Property(p =&gt; p.MyIdColumn, map =&gt;<br />
                                            {<br />
                                                map.Column(&quot;MyIdColumn&quot;);<br />
                                                map.Type&lt;MyIdColumnUserType&gt;();<br />
                                            }));</p>
<p>        Property(i =&gt; i.Country, map =&gt;<br />
                              {<br />
                                  map.Column(&quot;Country&quot;);<br />
                                  map.Type&lt;CountryEnumUserType&gt;();<br />
                              });<br />
    }<br />
}</p>
<p>public enum Country<br />
{<br />
	Australia,<br />
	Sri Lanka,<br />
	Brazil,<br />
	Spain<br />
}<br />
[/sourcecode]</p>
</div>
<p align="justify">Hope it helps someone else as well!</p>
